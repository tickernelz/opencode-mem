<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OpenCode Memory Explorer</title>
    <link rel="stylesheet" href="/styles.css" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <script src="https://unpkg.com/lucide@latest"></script>
  </head>
  <body>
    <div class="container">
      <header class="header">
        <div class="header-top">
          <h1 class="title">┌─ OPENCODE MEMORY EXPLORER ─┐</h1>
          <a
            href="https://github.com/tickernelz/opencode-mem"
            target="_blank"
            rel="noopener noreferrer"
            class="github-link"
            title="View on GitHub"
          >
            <i data-lucide="github" class="icon"></i>
          </a>
        </div>
        <div class="stats-bar">
          <span id="stats-total">Total: 0</span>
          <span id="stats-user">User: 0</span>
          <span id="stats-project">Project: 0</span>
          <span id="refresh-indicator" class="hidden"
            ><i data-lucide="rotate-cw" class="icon icon-spin"></i
          ></span>
        </div>
      </header>

      <div class="controls">
        <div class="filter-group">
          <label>Scope:</label>
          <select id="scope-filter">
            <option value="">All</option>
            <option value="user">User</option>
            <option value="project">Project</option>
          </select>
        </div>

        <div class="filter-group">
          <label>Tag:</label>
          <select id="tag-filter">
            <option value="">All Tags</option>
          </select>
        </div>

        <div class="search-group">
          <input type="text" id="search-input" placeholder="Search memories..." />
          <button id="search-btn"><i data-lucide="search" class="icon"></i></button>
          <button id="clear-search-btn" class="hidden"><i data-lucide="x" class="icon"></i></button>
        </div>

        <div class="maintenance-actions">
          <button id="cleanup-btn" class="btn-maintenance">
            <i data-lucide="trash" class="icon"></i> Cleanup
          </button>
          <button id="deduplicate-btn" class="btn-maintenance">
            <i data-lucide="refresh-cw" class="icon"></i> Deduplicate
          </button>
        </div>

        <div class="bulk-actions hidden" id="bulk-actions">
          <span id="selected-count">0 selected</span>
          <button id="bulk-delete-btn">
            <i data-lucide="trash-2" class="icon"></i> Delete Selected
          </button>
          <button id="deselect-all-btn"><i data-lucide="x" class="icon"></i> Deselect All</button>
        </div>
      </div>

      <div class="migration-section hidden" id="migration-section">
        <div class="migration-warning">
          <i data-lucide="alert-triangle" class="icon"></i>
          <span id="migration-message">Model dimension mismatch detected!</span>
        </div>
        <div class="migration-info">
          <label>
            <input type="checkbox" id="migration-confirm-checkbox" />
            I understand this operation is irreversible and will affect all stored memories
          </label>
        </div>
        <div class="migration-actions">
          <button id="migration-fresh-btn" class="btn-migration" disabled>
            <i data-lucide="trash" class="icon"></i> Fresh Start (Delete All)
          </button>
          <button id="migration-reembed-btn" class="btn-migration" disabled>
            <i data-lucide="refresh-cw" class="icon"></i> Re-embed (Preserve Data)
          </button>
        </div>
      </div>

      <div class="memories-section">
        <div class="section-header">
          <h2 id="section-title">└─ MEMORIES (0) ──</h2>
          <div class="pagination" id="pagination-top">
            <button id="prev-page-top" disabled>
              <i data-lucide="chevron-left" class="icon"></i>
            </button>
            <span id="page-info-top">Page 1 of 1</span>
            <button id="next-page-top" disabled>
              <i data-lucide="chevron-right" class="icon"></i>
            </button>
          </div>
        </div>

        <div id="memories-list" class="memories-list">
          <div class="loading">Initializing...</div>
        </div>

        <div class="pagination" id="pagination-bottom">
          <button id="prev-page-bottom" disabled>
            <i data-lucide="chevron-left" class="icon"></i>
          </button>
          <span id="page-info-bottom">Page 1 of 1</span>
          <button id="next-page-bottom" disabled>
            <i data-lucide="chevron-right" class="icon"></i>
          </button>
        </div>
      </div>

      <div class="add-section">
        <h2>└─ ADD NEW MEMORY ──</h2>
        <form id="add-form">
          <div class="form-row">
            <div class="form-group">
              <label>Scope:</label>
              <select id="add-scope" required>
                <option value="">Select scope</option>
                <option value="user">User</option>
                <option value="project">Project</option>
              </select>
            </div>

            <div class="form-group">
              <label>Tag:</label>
              <select id="add-tag" required>
                <option value="">Select tag</option>
              </select>
            </div>

            <div class="form-group">
              <label>Type:</label>
              <input type="text" id="add-type" placeholder="preference, architecture, etc." />
            </div>
          </div>

          <div class="form-group">
            <label>Content:</label>
            <textarea
              id="add-content"
              rows="4"
              placeholder="Enter memory content..."
              required
            ></textarea>
          </div>

          <button type="submit" class="btn-primary">
            <i data-lucide="plus" class="icon"></i> Add Memory
          </button>
        </form>
      </div>
    </div>

    <div id="edit-modal" class="modal hidden">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Edit Memory</h3>
          <button class="modal-close" id="modal-close"><i data-lucide="x" class="icon"></i></button>
        </div>
        <form id="edit-form">
          <input type="hidden" id="edit-id" />
          <div class="form-group">
            <label>Type:</label>
            <input type="text" id="edit-type" />
          </div>
          <div class="form-group">
            <label>Content:</label>
            <textarea id="edit-content" rows="6" required></textarea>
          </div>
          <div class="modal-actions">
            <button type="button" class="btn-secondary" id="cancel-edit">
              <i data-lucide="x" class="icon"></i> Cancel
            </button>
            <button type="submit" class="btn-primary">
              <i data-lucide="check" class="icon"></i> Save Changes
            </button>
          </div>
        </form>
      </div>
    </div>

    <div id="toast" class="toast hidden"></div>

    <script src="/app.js"></script>
  </body>
</html>
